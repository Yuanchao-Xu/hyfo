{
    "collab_server" : "",
    "contents" : "% Generated by roxygen2: do not edit by hand\n% Please edit documentation in R/multi-biasCorrect(generic).R\n\\docType{methods}\n\\name{getBiasFactor}\n\\alias{getBiasFactor}\n\\alias{getBiasFactor,data.frame,data.frame-method}\n\\alias{getBiasFactor,list,list-method}\n\\title{Get bias factor for multi/operational/real time bias correction.}\n\\usage{\ngetBiasFactor(hindcast, obs, method = \"scaling\", scaleType = \"multi\",\n  preci = FALSE, prThreshold = 0, extrapolate = \"no\")\n\n\\S4method{getBiasFactor}{data.frame,data.frame}(hindcast, obs,\n  method = \"scaling\", scaleType = \"multi\", preci = FALSE,\n  prThreshold = 0, extrapolate = \"no\")\n\n\\S4method{getBiasFactor}{list,list}(hindcast, obs, method = \"scaling\",\n  scaleType = \"multi\", preci = FALSE, prThreshold = 0,\n  extrapolate = \"no\")\n}\n\\arguments{\n\\item{hindcast}{a hyfo grid data output or a dataframe(time series) consists of Date column and one or more value columns, \nrepresenting the hindcast data. This data will be used in the calibration of the forecast, so it's better to have the same date period as\nobservation data. Check details for more information.}\n\n\\item{obs}{a hyfo grid data output or a dataframe (time series) consists of Date column and one or more value columns, \nrepresenting the observation data.}\n\n\\item{method}{bias correct method, including 'delta', 'scaling'...,default method is 'scaling'.}\n\n\\item{scaleType}{only when the method \"scaling\" is chosen, scaleType will be available. Two different types\nof scaling method, 'add' and 'multi', which means additive and multiplicative scaling method, default is 'multi'. More info check \ndetails.}\n\n\\item{preci}{If the precipitation is biascorrected, then you have to assign \\code{preci = TRUE}. Since for\nprecipitation, some biascorrect methods may not apply to, or some methods are specially for precipitation. \nDefault is FALSE, refer to details.}\n\n\\item{prThreshold}{The minimum value that is considered as a non-zero precipitation. Default to 1 (assuming mm).}\n\n\\item{extrapolate}{When use 'eqm' method, and 'no' is set, modified frc is bounded by the range of obs.\nIf 'constant' is set, modified frc is not bounded by the range of obs. Default is 'no'.}\n}\n\\description{\nWhen you do multi/operational/real time bias correction. It's too expensive\nto input hindcast and obs every time. Especially when you have a long period of hindcast\nand obs, but only a short period of frc, it's too unecessary to read and compute hindcast\nand obs everytime. Therefore, biasFactor is designed. Using \\code{getBiasFactor}, you can\nget the biasFactor with hindcast and observation, then you can use \\code{applyBiasFactor} to \napply the biasFactor to different forecasts.\n}\n\\details{\nInformation about the method and how biasCorrect works can be found in \\code{\\link{biasCorrect}}\n\n\\strong{why use biasFactor}\n\nAs for forecasting, for daily data, there is usually no need to have\ndifferent bias factor every different day. You can calculate one bisa factor using a long\nperiod of hindcast and obs, and apply that factor to different frc.\n\nFor example,\n\nYou have 10 years of hindcast and observation. you want to do bias correction for some \nforecasting product, e.g. system 4. For system 4, each month, you will get a new forecast\nabout the future 6 months. So if you want to do the real time bias correction, you have to\ntake the 10 years of hindcast and observation data with you, and run \\code{biasCorrect} every\ntime you get a new forecast. That's too expensive.\n\nFor some practical use in forecasting, there isn't a so high demand for accuracy. E.g.,\nMaybe for February and March, you can use the same biasFactor, no need to do the computation \nagain. \n \nIt is a generic function, if in your case you need to debug, please see \\code{?debug()} \nfor how to debug S4 method.\n}\n\\examples{\n\n######## hyfo grid file biascorrection\n########\n\n# If your input is obtained by \\\\code{loadNcdf}, you can also directly biascorrect\n# the file.\n\n# First load ncdf file.\nfilePath <- system.file(\"extdata\", \"tnc.nc\", package = \"hyfo\")\nvarname <- getNcdfVar(filePath)    \nnc <- loadNcdf(filePath, varname)\n\ndata(tgridData)\n# Since the example data, has some NA values, the process will include some warning #message, \n# which can be ignored in this case.\n\n\n\n# Then we will use nc data as forecasting data, and use itself as hindcast data,\n# use tgridData as observation.\n\nbiasFactor <- getBiasFactor(nc, tgridData)\nnewFrc <- applyBiasFactor(nc, biasFactor)\n   \nbiasFactor <- getBiasFactor(nc, tgridData, method = 'eqm', extrapolate = 'constant',\npreci = TRUE)\n# This method needs obs input.\nnewFrc <- applyBiasFactor(nc, biasFactor, obs = tgridData)\n\nbiasFactor <- getBiasFactor(nc, tgridData, method = 'gqm', preci = TRUE)\nnewFrc <- applyBiasFactor(nc, biasFactor) \n\n\n######## Time series biascorrection\n########\n\n# Use the time series from testdl as an example, we take frc, hindcast and obs from testdl.\ndata(testdl)\n\n# common period has to be extracted in order to better train the forecast.\n\ndatalist <- extractPeriod(testdl, startDate = '1994-1-1', endDate = '1995-10-1')\n\nfrc <- datalist[[1]]\nhindcast <- datalist[[2]]\nobs <- datalist[[3]]\n\n\n# The data used here is just for example, so there could be negative data.\n\n# default method is scaling\nbiasFactor <- getBiasFactor(hindcast, obs)\nfrc_new <- applyBiasFactor(frc, biasFactor)\n\n# for precipitation data, extra process needs to be executed, so you have to tell\n# the program to it is a precipitation data.\n\nbiasFactor <- getBiasFactor(hindcast, obs, preci = TRUE)\nfrc_new1 <- applyBiasFactor(frc, biasFactor)\n\n# You can use other methods to biascorrect, e.g. delta method. \nbiasFactor <- getBiasFactor(hindcast, obs, method = 'delta')\n# delta method needs obs input.\nfrc_new2 <- applyBiasFactor(frc, biasFactor, obs = obs)\n\n# \nbiasFactor <- getBiasFactor(hindcast, obs, method = 'eqm', preci = TRUE)\n# eqm needs obs input\nfrc_new3 <- applyBiasFactor(frc, biasFactor, obs = obs)\n\nbiasFactor <- getBiasFactor(hindcast, obs, method = 'gqm', preci = TRUE)\nfrc_new4 <- applyBiasFactor(frc, biasFactor)\n\nplotTS(obs, frc, frc_new, frc_new1, frc_new2, frc_new3, frc_new4, plot = 'cum')\n\n# You can also give name to this input list.\nTSlist <- list(obs, frc, frc_new, frc_new1, frc_new2, frc_new3, frc_new4)\nnames(TSlist) <- c('obs', 'frc', 'delta', 'delta_preci', 'scale', 'eqm', 'gqm')\nplotTS(list = TSlist, plot = 'cum')\n\n\n# If the forecasts you extracted only has incontinuous data for certain months and years, e.g.,\n# for seasonal forecasting, forecasts only provide 3-6 months data, so the case can be \n# for example Dec, Jan and Feb of every year from year 1999-2005.\n# In such case, you need to extract certain months and years from observed time series.\n# extractPeriod() can be then used.\n  \n  \n\n\n\n# More examples can be found in the user manual on https://yuanchao-xu.github.io/hyfo/\n\n\n}\n\\author{\nYuanchao Xu \\email{xuyuanchao37@gmail.com }\n}\n\\references{\nBias correction methods come from \\code{biasCorrection} from \\code{dowscaleR}\n\n\\itemize{\n\n\\item Santander Meteorology Group (2015). downscaleR: Climate data manipulation and statistical downscaling. R\npackage version 0.6-0. https://github.com/SantanderMetGroup/downscaleR/wiki\n\n\\item R.A.I. Wilcke, T. Mendlik and A. Gobiet (2013) Multi-variable error correction of regional climate models. Climatic Change, 120, 871-887\n\n\\item A. Amengual, V. Homar, R. Romero, S. Alonso, and C. Ramis (2012) A Statistical Adjustment of Regional Climate Model Outputs to Local Scales: Application to Platja de Palma, Spain. J. Clim., 25, 939-957\n\n\\item C. Piani, J. O. Haerter and E. Coppola (2009) Statistical bias correction for daily precipitation in regional climate models over Europe, Theoretical and Applied Climatology, 99, 187-192\n\n\\item O. Gutjahr and G. Heinemann (2013) Comparing precipitation bias correction methods for high-resolution regional climate simulations using COSMO-CLM, Theoretical and Applied Climatology, 114, 511-529\n}\n}\n\\seealso{\n\\code{\\link{biasCorrect}} for method used in bias correction.\n\\code{\\link{applyBiasFactor}}, for the second part.\n}\n\n",
    "created" : 1487956242592.000,
    "dirty" : false,
    "encoding" : "ASCII",
    "folds" : "",
    "hash" : "670227453",
    "id" : "9DAD3561",
    "lastKnownWriteTime" : 1488018205,
    "last_content_update" : 1488018205,
    "path" : "~/GitHub/hyfo/man/getBiasFactor.Rd",
    "project_path" : "man/getBiasFactor.Rd",
    "properties" : {
    },
    "relative_order" : 30,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_doc"
}